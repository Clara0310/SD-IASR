==========================================================
開始執行前處理程序
資料集: Grocery_and_Gourmet_Food
參數設定已儲存至: data_preprocess_log/Grocery_and_Gourmet_Food/20260204_1243/sh_setting.yaml
Log 紀錄中: data_preprocess_log/Grocery_and_Gourmet_Food/20260204_1243/process.log
==========================================================
[Step 1/7] Running 1_feature_filter.py...
Filtering items for Grocery_and_Gourmet_Food with incomplete features...
Finished! Total valid nodes: 94163
Unique CID2: 95, Unique CID3: 565
Filtered data saved to: ./data_preprocess/tmp/filtered_meta_Grocery_and_Gourmet_Food.json
[Step 2/7] Running 2_edge_extractor.py...
Extracting Dual-View edges for Grocery_and_Gourmet_Food...
Extraction finished!
Total Similarity edges (also_view): 225975
Total Complementarity edges (also_buy): 374968
[Step 3/7] Running 3_edge_filter.py...
Filtering nodes with edge num threshold = 1
Round 1
Current valid nodes: 68205
Filtering finished! Final valid nodes: 68205
Filtered edges saved to tmp/filtered_...
[Step 4/7] Running 4_data_formulator.py...
Formulating JSON data for Grocery_and_Gourmet_Food...
Finished! Total nodes formulated: 68205
Data saved to: ./data_preprocess/data/Grocery_and_Gourmet_Food.json
[Step 5/7] Running 5_embs_generator.py...
/home/clara_r76121188/thesis/SD-IASR/.venv/lib64/python3.9/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertModel: ['cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.transform.dense.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Generating category embeddings with BERT for Grocery_and_Gourmet_Food...
Using device: cuda
Processing category level 2, total unique names: 92
Category 2 embedding shape: (92, 768)
Processing category level 3, total unique names: 545
Category 3 embedding shape: (545, 768)
Embeddings saved to: ./data_preprocess/embs/Grocery_and_Gourmet_Food_embeddings.npz
[Step 6/7] Running 6_seq_constructor.py...
Reading interactions from ./data_preprocess/raw_data/Grocery_and_Gourmet_Food.json...
Processed 100000 lines...
Processed 200000 lines...
Processed 300000 lines...
Processed 400000 lines...
Processed 500000 lines...
Processed 600000 lines...
Processed 700000 lines...
Processed 800000 lines...
Processed 900000 lines...
Processed 1000000 lines...
Processed 1100000 lines...
Processed 1200000 lines...
Processed 1300000 lines...
Processed 1400000 lines...
Processed 1500000 lines...
Processed 1600000 lines...
Processed 1700000 lines...
Processed 1800000 lines...
Processed 1900000 lines...
Processed 2000000 lines...
Processed 2100000 lines...
Processed 2200000 lines...
Processed 2300000 lines...
Processed 2400000 lines...
Processed 2500000 lines...
Processed 2600000 lines...
Processed 2700000 lines...
Processed 2800000 lines...
Processed 2900000 lines...
Processed 3000000 lines...
Processed 3100000 lines...
Processed 3200000 lines...
Processed 3300000 lines...
Processed 3400000 lines...
Processed 3500000 lines...
Processed 3600000 lines...
Processed 3700000 lines...
Processed 3800000 lines...
Processed 3900000 lines...
Processed 4000000 lines...
Processed 4100000 lines...
Processed 4200000 lines...
Processed 4300000 lines...
Processed 4400000 lines...
Processed 4500000 lines...
Processed 4600000 lines...
Processed 4700000 lines...
Processed 4800000 lines...
Processed 4900000 lines...
Processed 5000000 lines...
Sorting sequences by time and saving timestamps...
Finished!
Total users with valid sequences: 173170
Sequences with timestamps saved to: ./data_preprocess/tmp/Grocery_and_Gourmet_Food_sequences_with_time.json
[Step 7/7] Running 7_dataset_split.py...
Loading product data from ./data_preprocess/data/Grocery_and_Gourmet_Food.json...
Loading sequences from ./data_preprocess/tmp/Grocery_and_Gourmet_Food_sequences_with_time.json...
Constructing dataset pairs (Train neg: 20, Test neg: 100)...
Success! Processed data saved to: ./data_preprocess/processed/Grocery_and_Gourmet_Food.npz
Final items: 68205, Sequences: 173170
==========================================================
前處理執行完畢！所有紀錄已儲存於: data_preprocess_log/Grocery_and_Gourmet_Food/20260204_1243
完成時間: 2026-02-04 12:45:47
==========================================================
